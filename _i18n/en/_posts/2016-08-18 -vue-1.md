---
layout: post
title: Vue.js Learning Notes I: Getting Started
date: 2016-08-18 19:05:16
tags: [Vue]
categories:
 - web-framework
---

## Preface

vue is French for view, and Vue.js is a lightweight, high-performance, componentizable MVVM library.
　　We may have heard about `MV*` a lot, so let's first understand the concept of `MV*`.

<!--more-->

### Context in which it emerged

MVC began to exist in desktop programs, but as the back-end mvc frameworks became heavier and heavier in the v-layer, the back-end MVC ideas moved to the front-end. As front-end code became heavier and more capable, more and more front-end heavy systems sprang up. Front-end-oriented MV * era, the front-end in the MVC structure under the guidance of the model (model), view (view), controller (controller) three parts. The controller slowly evolved into the presenter and viewmodel. MVC, MVP, MVVM frameworks continue to emerge.

### MVC, MVP, MVVM

* :: MVC (model-view-controller), e.g., backbone, angular (the higher version is mvvm, which is probably more accurately described as MVW).

View: the part of the page that is directly related to the elements on the page, including html, CSS and a part of the JS that directly controls the elements on the page. it can get the data from the Model and display it to the page.
　　Model: communication with the backend, AJAX requests and processing of data. model itself does not know who is View and who is Controller. it only provides some methods for View and Controller to call, and notify changes to its observer.
　　Controller: The glue between Model and View, Controller forwards requests from View to the appropriate Model, acts as an observer of the Model, gets changes to the Model, and updates the View when necessary.

* MVP (model-view-presenter) Not many frameworks use this model, and now it's almost backwards to MVVM. the MVP model renames the Controller to Presenter, and also changes the direction of the communication.

Presenter, like Controller, receives commands from View and performs operations on Model; the difference with Controller is that Presenter reacts on View, the notification of Model's change is first obtained by Presenter, and then Presenter goes to update View.

* :: MVVM (model-view-viewmodel) such as Vue.js. the Controller is changed to ViewModel. the difference between it and MVP is that it uses two-way binding (data-binding): changes to the View are automatically reflected in the ViewModel.

The following diagram from [Understanding MVC, MVP, MVVM](https://blog.csdn.net/napolunyishi/article/details/22722345) clearly illustrates the differences between them
! [mvc,mvp and mvvm](/assets/img/2016/08/mvc.png)

## Vue.js Getting Started

### Briefly

* Mr. You Yuxi wrote a library used to create web interactive interface, is a streamlined MVVM, and other libraries compared to a small but beautiful library
* official documentation is very clear, than Angular easy to learn
* using two-way binding, with decoupled components to combine your application

! [vue.js overview](/assets/img/2016/08/vue1.png)

Below is a small example of two-way binding on the [vue.js website](https://vuejs.org/). First, VM -> V, the change of message in data in VM will be automatically reflected in the message in curly brackets in p tag in V. V -> VM, the value entered in input in V will be automatically reflected in the value of message in VM. So, the text you type in the input box will be displayed in real time as the text above.
! [vue.js official website example](/assets/img/2016/08/vuedemo.png)

### Installation

The installation steps [vue.js official website](https://vuejs.org.cn/guide/installation.html) are described very clearly. Here I recommend installing [Taobao Mirror](https://npm.taobao.org/) first, and then proceeding to install the official Vue.js command line tool, which will be faster.

``` bash
# 全局安装 cnpm淘宝镜像
$ npm install -g cnpm --registry=https://registry.npm.taobao.org
# 全局安装 vue-cli
$ cnpm install -g vue-cli
# 创建一个基于 "webpack" 模板的新项目
$ vue init webpack my-project
# 安装依赖，走你
$ cd my-project
$ cnpm install
$ npm run dev
```

## Some common commands

### v-model

Usage: Create two-way bindings on form controls (`<input>`, `<select>`, `<textarea>`).
　　Example: The initialized text in the input box is `hello vue.js`, and the text you type in the input box is displayed in real time as the text above it.

``` html
<div id="app">
    <p>{{newItem}}</p>
    <input v-model="newItem"/>
</div>
```

``` js
new Vue({
    el:'#app',
    data: {
        newItem:'hello vue.js.'
    }
});
```

### v-for

Usage: Repeat an element or template block several times based on the source data, which simply means list rendering. If you have learned Angular before, you will find it very similar.
　　Example: A list will be displayed with "No.1" and "No.2" in it.

``` html
<ul>
  <li v-for="item in items">
    {{item.label}}
  </li>
</ul>
```

``` js
new Vue({
    el:'#app',
    data: {
        newItem:'hello vue.js.',
        items: [
        	{label: "No.1",isFinished: false},
        	{label: "No.2",isFinished: true}
        ]
    }
});
```

### v-on

Usage: Bind an event listener. The event type is specified by the argument. The expression can be a method name or an inline statement, or it can be omitted if there are no modifiers (e.g. .stop, .prevent, etc.).
　　Example: `<li>` tag has a click event bound to it, which changes the item's isFinished property with each click. v-on:click can be abbreviated to @click.

``` html
<ul>
  <li v-for="item in items" v-on:click="toggleFinish(item)">
    {{item.label}}
  </li>
</ul>
```

``` js
new Vue({
    methods: {
      toggleFinish: function(item) {
        item.isFinished = !item.isFinished
      }
    }
});
```

### v-bind

Usage: Dynamically bind one or more attributes, or a component prop to an expression. When binding class or style, other types of values, such as arrays or objects, are supported; when binding prop, the prop must be declared in a subcomponent. Different binding types can be specified with modifiers.
　　Example: If `<li>`'s data item.isFinished is true, `<li>`'s class is finished, and the text color will be #ccc. v-bind:class can be abbreviated to :class.

``` html
<ul>
  <li v-for="item in items" v-bind:class="{finished: item.isFinished}" v-on:click="toggleFinish(item)">
    {{item.label}}
  </li>
</ul>
```

``` css
.finished {
  color: #ccc;
}
```

### The parent passes a parameter to the child component

Example: App.vue as the parent, after the introduction of componetA component, then you can use the <component-a> tag in the template (note that the camel writing should be changed to componet-a writing, because html is not sensitive to case, componenta and componentA for it is the same, not good to (differentiate, so use lowercase-lowercase this writing style). In the subcomponent componetA, after declaring the props parameter 'msgfromfa', you can receive the parameters passed by the parent to the subcomponent. The example displays msgfromfa in the `<p>` tag.
In App.vue

``` html
<component-a msgfromfa="(Just Say U Love Me)"></component-a>
```

``` js
import componentA from './components/componentA'
export default {
    new Vue({
        components: {
          componentA
        }
    })
}
```

in componentA.vue

``` html
<p>{{ msgfromfa }}</p>
```

``` js
export default {
    props: ['msgfromfa']
}
```

### The parent passes a parameter to the child component (. $broadcast)

Usage: vm.$broadcast( event, [...args] ) broadcasts an event to all descendants of the current instance. Since the descendants have multiple branches, the event will be notified along each "path".
　　Example: Parent component App.vue has `<input>` bound to keyboard event, enter triggers addNew method, broadcasts event "onAddnew" and passes this.items. Child componentA registers "onAddnew" event and prints received items.
In App.vue

``` html
<div id="app">
    <input v-model="newItem" @keyup.enter="addNew"/>
</div>
```

``` js
import componentA from './components/componentA'
export default {
    new Vue({
    	methods: {
    	  addNew: function() {
    	    this.$broadcast('onAddnew', this.items)
    	  }
    	}
    })
}
```

in componentA.vue

``` js
import componentA from './components/componentA'
export default {
    events: {
        'onAddnew': function(items){
          console.log(items)
        }
    }
}
```

### The child component passes a parameter to the parent (. $emit)

Usage: vm.$emit( event, [...args] ), triggers an event on the current instance. Additional arguments are passed to the listener callback.
　　Example: Component-a in App.vue has a custom event "child-say" bound to it. In the child component componentA, the "child-say" event is triggered when the button is clicked and the msg is passed to the parent component. The listenToMyBoy method in the parent component assigns the msg to the childWords, which are displayed in the `<p>` tag.
In App.vue

``` html
<p>Do you like me? {{childWords}}</p>
<component-a msgfromfa="(Just Say U Love Me)" v-on:child-say="listenToMyBoy"></component-a>
```

``` js
import componentA from './components/componentA'
export default {
    new Vue({
    	data: function () {
    	    return {
    	      childWords: ""
    	    }
    	},
    	components: {
    	  componentA
    	},
        methods: {
    	    listenToMyBoy: function (msg){
    	      this.childWords = msg
    	    }
    	}
    })
}
```

in componentA.vue

``` html
<button v-on:click="onClickMe">like!</button>
```

``` js
import componentA from './components/componentA'
export default {
    data: function () {
        return {
          msg: 'I like you!'
        }
    },
    methods: {
      onClickMe: function(){
        this.$emit('child-say',this.msg);
      }
    }
}
```

### The child component passes a parameter to the parent (. $dispatch)

Usage: vm.$dispatch( event, [...args] ), dispatches the event, first triggering it on the instance, then bubbling up the parent chain and stopping when a listener is triggered.
　　Example: The "child-say" event is registered in events in App.vue. In the child component componentA, the "child-say" event is triggered when the button is clicked and the msg is passed to the parent component. The "child-say" method in the parent component assigns the msg to childWords, which are displayed in the `<p>` tag.
In App.vue

``` html
<p>Do you like me? {{childWords}}</p>
<component-a msgfromfa="(Just Say U Love Me)"></component-a>
```

``` js
import componentA from './components/componentA'
export default {
    new Vue({
    	events: {
    	    'child-say' : function(msg){
    	      this.childWords = msg
    	    }
    	}
    })
}
```

in componentA.vue

``` html
<button v-on:click="onClickMe">like!</button>
```

``` js
import componentA from './components/componentA'
export default {
    data: function () {
        return {
          msg: 'I like you!'
        }
    },
    methods: {
      onClickMe: function(){
        this.$dispatch('child-say',this.msg);
      }
    }
}
```

Only a few commands are mentioned here, for more functionality it is recommended to brush up on [API documentation](https://vuejs.org.cn/api/#vm-emit) on the official website.

## Make a todolist ##

Write a simple demo with the above commands to realize the functions of adding things, deleting things, clicking things to indicate that things have been completed, liking things, etc. The code idea comes from the tutorial on MU.com. Code ideas from the tutorial, I made some changes.
　　The detailed code is as follows:

### src/App.vue

``` html
<template>
  <div id="app">
    <h1 v-text="title"></h1>
    <input v-model="newItem" @keyup.enter="addNew"/>
    <ul>
      <li v-for="item in items" v-bind:class="{finished: item.isFinished}" v-on:click="toggleFinish(item)">
        ❤ {{item.label}}
        <span v-on:click="deleteThis(item)">delete</span>
        <hr/>
      </li>
    </ul>

    <p>Do you like me? {{childWords}}</p>
    <component-a msgfromfa="(Just Say U Love Me)"></component-a>
  </div>
</template>
<script>
import Store from './store'
import componentA from './components/componentA'
//相当于module.export
export default {
  /*function data(){
    return...
  }*/
  /*相当于var vue = new vue({data: function(){}})*/
  data () {
    return {
      title: 'TODO LIST',
      items: Store.fetch() || [],
      newItem: '',
      childWords: ''
    }
  },
  components: {
    componentA
  },
  watch: {
    items: {
      handler: function(items){
        Store.save(items)
      },
      deep: true
    }
  },
  events: {
    'child-say' : function(msg){
      this.childWords = msg
    }
  },
  methods: {
    toggleFinish: function(item) {
      item.isFinished = !item.isFinished
    },
    addNew: function() {
      this.items.push({
        label: this.newItem,
        isFinished: false
      })
      this.newItem = ''
      this.$broadcast('onAddnew', this.items)
    },
    listenToMyBoy: function (msg){
      this.childWords = msg
    },
    deleteThis: function(item) {
      this.items.splice(this.items.indexOf(item), 1)
      Store.save(this.items)
    }
  }
}
</script>

<style>
*{
  margin: 0;
  padding: 0;
}
html {
  height: 100%;
}

body {
  display: flex;
  align-items: center;
  justify-content: center;
  height: 100%;
  width: 100%;
}

#app {
  color: #2c3e50;
  font-family: Source Sans Pro, Helvetica, sans-serif;
  text-align: center;
  width: 60%;
}

#app a {
  color: #42b983;
  text-decoration: none;
}
#app h1:nth-child(1) {
  line-height: 3;
  position: absolute;
  top: 10%;
}
#app input {
  width: 60%;
  line-height: 24px;
  font-size: 24px;
  position: absolute;
  top: 25%; left: 20%;
}

ul {
  position: absolute;
  top: 35%;
  text-align: left;
  width: 60%;
  height: 45%;
  overflow: auto;
}

ul li {
  list-style: none;
  line-height: 2;
  font-size: 24px;
}
span {
  font-size: 16px;
  color: #fff;
  padding: 2px 5px;
  text-align: right;
  background-color: red;
  border-radius: 5px;
}
.logo {
  width: 100px;
  height: 100px
}
.finished {
  color: #ccc;
}
hr {
  ;border-top:1px dashed #ccc;
}
p {
  text-align: left;
  position: absolute;
  bottom: 10%;
}
</style>
```

### src/components/componentA.vue

``` html
<template>
  <div class="hello">
    <p>{{ msgfromfa }}</p>
    <button v-on:click="onClickMe">like!</button>
  </div>
</template>
<script>
export default {
  data: function () {
    return {
      msg: 'I like you!'
    }
  },
  props: ['msgfromfa'],
  events: {
    'onAddnew': function(items){
      console.log(items)
    }
  },
  methods: {
    onClickMe: function(){
      this.$dispatch('child-say',this.msg);
    }
  }
}
</script>

<!-- Add "scoped" attribute to limit CSS to this component only -->
<style scoped>
h1 {
  color: #42b983;
}
button {
  position: absolute;
  bottom: 10%;
  right: 20%;
  width: 100px;
  background-color: green;
  font-size: 16px;
  color: #fff;
  padding: 2px 5px;
  border: none;
}
.hello p {
  bottom: 5%;
  font-size: 12px;
  color: green;
}
</style>
```

### src/store.js

``` js
const STORAGE_KEY = 'todos-vuejs'//es6语法 const定义一个常量
export default {
    fetch () {//es6语法 相当于 fetch:function(){}
    	return JSON.parse(window.localStorage.getItem(STORAGE_KEY) || '[]')
    },
    save (items) {
    	window.localStorage.setItem(STORAGE_KEY, JSON.stringify(items))
    }
}
```

When finished, the picture below:
! [ToDoList](/assets/img/2016/08/todolist.png)

## Reference

* [vuejs introductory fundamentals (MUJ.com video)](https://www.imooc.com/view/694)
* [Vue.js Quick Start](https://segmentfault.com/a/1190000003968020)
* [Talk about MVC pattern](https://www.ruanyifeng.com/blog/2007/11/mvc.html)
* [Big front-end technology sharing](https://zakwu.me/node/assets/ppts/tpls/bigFe.html)
* [Understanding of MVC, MVP, MVVM](https://blog.csdn.net/napolunyishi/article/details/22722345)
